<!DOCTYPE html>
<!-- í•œêµ­ì–´ ì„¤ì •ìœ¼ë¡œ ë¬¸ì„œì˜ ê¸°ë³¸ ì–¸ì–´ë¥¼ ì§€ì •í•©ë‹ˆë‹¤ -->
<html lang="ko">
<head>
    <!-- ë¸Œë¼ìš°ì € ì¸ì½”ë”©ì„ UTF-8ë¡œ ì„¤ì •í•˜ì—¬ í•œê¸€ ê¹¨ì§ì„ ë°©ì§€í•©ë‹ˆë‹¤ -->
    <meta charset="UTF-8">
    <!-- ëª¨ë°”ì¼ ê¸°ê¸°ì—ì„œë„ í™”ë©´ì´ ìµœì í™”ë˜ë„ë¡ ë·°í¬íŠ¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- í†µí•© ë³´ì•ˆ ìˆ˜ì‚¬ë³¸ë¶€ V3.2 ìµœì¢… í†µí•©ë³¸ ì œëª©ì…ë‹ˆë‹¤ -->
    <title>CERT í†µí•© ë³´ì•ˆ ìˆ˜ì‚¬ë³¸ë¶€ V3.2</title>
    <!-- ë””ìì¸ ìƒì‚°ì„±ì„ ìœ„í•´ í…Œì¼ìœˆë“œ CSS í”„ë ˆì„ì›Œí¬ë¥¼ ì™¸ë¶€ CDNì—ì„œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ë°ì´í„° ì‹œê°í™”ë¥¼ ìœ„í•œ Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì™¸ë¶€ CDNì—ì„œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ì‹œìŠ¤í…œ ì „ì²´ì— ë…¸í† ì‚°ìŠ¤ í•œê¸€ í°íŠ¸ë¥¼ ì ìš©í•©ë‹ˆë‹¤ */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        body {
            /* í°íŠ¸ íŒ¨ë°€ë¦¬ ì§€ì • ë° ë°°ê²½ìƒ‰ì„ ì„¸ë ¨ëœ ë°ì€ íšŒìƒ‰ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤ */
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
            overflow-x: hidden;
        }

        /* ì°¨íŠ¸ê°€ ë¶€ëª¨ ìš”ì†Œì— ë§ì¶° ìœ ë™ì ìœ¼ë¡œ í¬ê¸°ê°€ ë³€í•˜ë„ë¡ ì»¨í…Œì´ë„ˆë¥¼ ì •ì˜í•©ë‹ˆë‹¤ */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 100%;
            margin: auto;
            height: 250px;
        }

        /* í™”ë©´ ë“±ì¥ ì‹œ ë¶€ë“œëŸ½ê²Œ ë‚˜íƒ€ë‚˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ì…ë‹ˆë‹¤ */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ë””ìì¸ìœ¼ë¡œ ê°€ë…ì„±ì„ ë†’ì…ë‹ˆë‹¤ */
        .custom-scrollbar::-webkit-scrollbar { width: 5px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        /* ì ê²€ í•­ëª© ì¹´ë“œì— í˜¸ë²„ íš¨ê³¼ë¥¼ ì£¼ì–´ ì¸í„°ë™í‹°ë¸Œí•¨ì„ ë”í•©ë‹ˆë‹¤ */
        .check-item { transition: all 0.2s ease; cursor: pointer; }
        .check-item:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

        /* ëŒ€ì‘ ê°€ì´ë“œ ì˜ì—­ ì• ë‹ˆë©”ì´ì…˜: ìƒì„¸ ì¡°ì¹˜ ë°©ë²• ì¶œë ¥ìš©ì…ë‹ˆë‹¤ */
        .remedy-area { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .check-item.active .remedy-area { max-height: 500px; }

        /* ë©”ì¼ ì „ë‹¬ ê²½ë¡œ(Hop)ë¥¼ ìœ„í•œ íƒ€ì„ë¼ì¸ ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤ */
        .mail-hop-node {
            position: relative;
            padding-left: 2rem;
            border-left: 2px dashed #cbd5e1;
            margin-bottom: 1.5rem;
        }
        .mail-hop-node::before {
            content: '';
            position: absolute;
            left: -7px;
            top: 0;
            width: 12px;
            height: 12px;
            background-color: #6366f1;
            border-radius: 50%;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- í†µí•© í—¤ë”: ê° ë¶„ì„ ì„¼í„°ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ë‚´ë¹„ê²Œì´ì…˜ ë°”ì…ë‹ˆë‹¤ -->
    <header class="bg-slate-900 text-white shadow-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center font-black text-white">CERT</div>
                <div>
                    <h1 class="text-base font-bold leading-tight">CERT í†µí•© ìˆ˜ì‚¬ë³¸ë¶€</h1>
                    <p class="text-[9px] text-indigo-400 uppercase tracking-widest">Global Threat Intelligence v3.2</p>
                </div>
            </div>
            <!-- ìˆ˜ì‚¬ë³¸ë¶€ ë‚´ ì£¼ìš” ì„¼í„° ì´ë™ ë²„íŠ¼ì…ë‹ˆë‹¤ -->
            <nav class="hidden md:flex gap-6 text-xs font-bold">
                <button onclick="app.switchView('analysis')" class="hover:text-indigo-400 transition">ë¶„ì„ ì„¼í„°</button>
                <button onclick="app.switchView('codec')" class="hover:text-indigo-400 transition">ì¸/ë””ì½”ë“œ ì„¼í„°</button>
                <button onclick="app.switchView('system')" class="hover:text-indigo-400 transition">ì‹œìŠ¤í…œ ì ê²€ ì„¼í„°</button>
            </nav>
            <div class="text-right">
                <p class="text-[10px] text-slate-500 font-bold">ë³´ì•ˆ ì´ê´„ ë³´ì¢Œ ì¤‘</p>
                <p class="text-xs text-emerald-400 font-bold">System: Protected</p>
            </div>
        </div>
    </header>

    <main class="flex-grow p-4 md:p-8 max-w-7xl mx-auto w-full">

        <!-- ì„¹ì…˜ 1: ë¶„ì„ ì„¼í„° (íŒŒì¼ ë° ì´ë©”ì¼ ì •ë°€ ë¶„ì„) -->
        <section id="view-analysis" class="space-y-8 fade-in">
            <div id="analysis-input-stage" class="grid grid-cols-1 lg:grid-cols-2 gap-8 my-10">
                <!-- íŒŒì¼ ë¶„ì„ ì…ë ¥ ì˜ì—­ì…ë‹ˆë‹¤ -->
                <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">ğŸ“‚ ì—”ë“œí¬ì¸íŠ¸ ë¶„ì„</h3>
                    <input type="file" id="file-input" class="hidden" onchange="app.handleFileSelect(event)">
                    <div id="file-drop-zone" class="border-2 border-dashed border-slate-100 bg-slate-50 rounded-2xl p-10 text-center cursor-pointer hover:bg-indigo-50 transition" onclick="document.getElementById('file-input').click()">
                        <p class="text-sm text-slate-500 font-bold">ì•…ì„± ì˜ì‹¬ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš” (Click or Drop)</p>
                        <p class="text-[10px] text-slate-300 mt-2">ë¶„ì„ê¸° ê°€ë™ ì¤€ë¹„ ì™„ë£Œ</p>
                    </div>
                </div>
                <!-- ì´ë©”ì¼ í—¤ë” ë¶„ì„ ì…ë ¥ ì˜ì—­ì…ë‹ˆë‹¤ -->
                <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">ğŸ“§ ì´ë©”ì¼ í—¤ë” ë¶„ì„</h3>
                    <textarea id="email-header-input" class="w-full h-24 p-4 bg-slate-50 border border-slate-100 rounded-xl text-xs font-mono mb-4 outline-none focus:ring-2 focus:ring-indigo-500" placeholder="ì´ë©”ì¼ í—¤ë” ì „ë¬¸ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
                    <button onclick="app.startEmailAnalysis()" class="w-full py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 transition">í—¤ë” ë¶„ì„ ì‹œì‘</button>
                </div>
            </div>

            <!-- ë¶„ì„ ë¡œë”© í™”ë©´ì…ë‹ˆë‹¤ -->
            <div id="analysis-loader-stage" class="hidden py-20 text-center">
                <div class="w-20 h-20 border-8 border-slate-200 border-t-indigo-600 rounded-full animate-spin mx-auto mb-8"></div>
                <h3 class="text-xl font-black text-slate-800 mb-2" id="analysis-loader-title">ë°ì´í„° ë¶„ì„ ì¤‘...</h3>
                <p class="text-slate-500 text-sm" id="analysis-loader-status">ê°€ìƒ ìƒŒë“œë°•ìŠ¤ ì´ˆê¸°í™” ë° ë ˆì½”ë“œ ì¡°íšŒ ì¤‘</p>
            </div>

            <!-- ë¶„ì„ ê²°ê³¼ ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤ -->
            <div id="analysis-result-stage" class="hidden space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="md:col-span-2 bg-white p-6 rounded-3xl shadow-sm border border-slate-200 flex items-center justify-between">
                        <div class="flex items-center gap-5">
                            <div class="w-16 h-16 bg-rose-50 text-rose-600 rounded-2xl flex items-center justify-center text-4xl font-bold border border-rose-100 animate-pulse">!</div>
                            <div>
                                <h2 class="text-2xl font-black text-slate-800" id="analysis-verdict-title">ìœ„í˜‘ íƒì§€: ê³ ìœ„í—˜(High)</h2>
                                <p class="text-slate-500 text-xs" id="analysis-verdict-target">ë¶„ì„ ëŒ€ìƒ: --</p>
                            </div>
                        </div>
                        <div class="text-center bg-rose-50 px-6 py-2 rounded-2xl border border-rose-100">
                            <p class="text-[10px] text-rose-400 font-bold uppercase">ìœ„í—˜ ì§€ìˆ˜</p>
                            <p class="text-3xl font-black text-rose-600">92</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200 flex flex-col items-center justify-center">
                        <div class="chart-container" style="height: 140px;">
                            <canvas id="gaugeChart"></canvas>
                        </div>
                        <p class="text-xs font-black text-slate-400 mt-2 uppercase">Risk Index</p>
                    </div>
                </div>

                <!-- íƒ­ ë©”ë‰´ì…ë‹ˆë‹¤ -->
                <div class="flex gap-2 overflow-x-auto pb-2 custom-scrollbar">
                    <button onclick="app.switchTab('email')" id="tab-email" class="px-6 py-2.5 bg-indigo-600 text-white rounded-full text-sm font-bold shadow-md whitespace-nowrap">ğŸ“§ ì´ë©”ì¼ ë¶„ì„</button>
                    <button onclick="app.switchTab('network')" id="tab-network" class="px-6 py-2.5 bg-white text-slate-500 rounded-full text-sm font-bold border border-slate-200 whitespace-nowrap">ğŸŒ ë„¤íŠ¸ì›Œí¬ í™œë™</button>
                    <button onclick="app.switchTab('system-log')" id="tab-system-log" class="px-6 py-2.5 bg-white text-slate-500 rounded-full text-sm font-bold border border-slate-200 whitespace-nowrap">ğŸ“‚ ì‹œìŠ¤í…œ í–‰ìœ„</button>
                    <button onclick="app.switchTab('cert-report')" id="tab-cert-report" class="px-6 py-2.5 bg-white text-slate-500 rounded-full text-sm font-bold border border-slate-200 whitespace-nowrap">ğŸ“‹ ìµœì¢… ë¦¬í¬íŠ¸</button>
                </div>

                <!-- íƒ­ ì½˜í…ì¸ : ì´ë©”ì¼ ë¶„ì„ -->
                <div id="content-email" class="tab-content grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                            <h3 class="font-bold text-slate-800 mb-6">ğŸ“¡ ì „ë‹¬ ê²½ë¡œ (Relay Path)</h3>
                            <div id="mail-hop-container" class="space-y-1"></div>
                        </div>
                        <div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden text-xs">
                            <div class="p-4 bg-slate-50 border-b border-slate-200 font-bold">í—¤ë” ìƒì„¸ ë°ì´í„°</div>
                            <div id="header-data-table" class="divide-y divide-slate-100"></div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-6">ì¸ì¦ í”„ë¡œí† ì½œ ê²€ì¦</h3>
                        <div class="chart-container"><canvas id="authChart"></canvas></div>
                        <div id="auth-status-list" class="mt-6 space-y-3"></div>
                    </div>
                </div>

                <!-- íƒ­ ì½˜í…ì¸ : ë„¤íŠ¸ì›Œí¬ í™œë™ -->
                <div id="content-network" class="hidden tab-content grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
                        <div class="p-5 bg-slate-50 border-b border-slate-200 font-bold">ë„¤íŠ¸ì›Œí¬ ì»¤ë„¥ì…˜ ë¡œê·¸</div>
                        <table class="w-full text-xs text-left">
                            <thead class="bg-slate-50 text-slate-400 font-bold border-b border-slate-100">
                                <tr><th class="px-6 py-4">í”„ë¡œì„¸ìŠ¤</th><th class="px-6 py-4">ì›ê²© ì£¼ì†Œ</th><th class="px-6 py-4">í¬íŠ¸</th><th class="px-6 py-4">ìƒíƒœ</th></tr>
                            </thead>
                            <tbody id="net-table-body" class="divide-y divide-slate-100"></tbody>
                        </table>
                    </div>
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-6">íŠ¸ë˜í”½ ì¶”ì´</h3>
                        <div class="chart-container"><canvas id="trafficLineChart"></canvas></div>
                    </div>
                </div>

                <!-- íƒ­ ì½˜í…ì¸ : ì‹œìŠ¤í…œ í–‰ìœ„ -->
                <div id="content-system-log" class="hidden tab-content">
                    <div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
                        <div class="p-5 bg-slate-50 border-b border-slate-200 font-bold">ì‹œìŠ¤í…œ í˜¸ì¶œ ë¡œê·¸ (Procmon)</div>
                        <div id="sys-log-list" class="max-h-[500px] overflow-y-auto custom-scrollbar"></div>
                    </div>
                </div>

                <!-- íƒ­ ì½˜í…ì¸ : CERT ë¦¬í¬íŠ¸ -->
                <div id="content-cert-report" class="hidden tab-content">
                    <div class="bg-slate-900 text-white rounded-3xl p-10 shadow-2xl relative overflow-hidden">
                        <div class="absolute -top-10 -right-10 w-64 h-64 bg-indigo-500/10 rounded-full blur-3xl"></div>
                        <div class="relative z-10 space-y-6">
                            <h3 class="text-3xl font-black">CERT í†µí•© ë¶„ì„ ë³´ê³ ì„œ</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div class="bg-white/5 p-6 rounded-2xl border border-white/10">
                                    <h4 class="font-bold text-rose-400 mb-4 uppercase text-sm">ìœ„í˜‘ ê²°ë¡ </h4>
                                    <ul id="report-verdict-list" class="space-y-3 text-sm text-slate-300"></ul>
                                </div>
                                <div class="bg-white/5 p-6 rounded-2xl border border-white/10">
                                    <h4 class="font-bold text-emerald-400 mb-4 uppercase text-sm">ëŒ€ì‘ ê°€ì´ë“œ</h4>
                                    <ul id="report-guide-list" class="space-y-3 text-sm text-slate-300"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ì„¹ì…˜ 2: ì¸/ë””ì½”ë“œ ì„¼í„° -->
        <section id="view-codec" class="hidden space-y-6 fade-in">
            <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
                    <div>
                        <h2 class="text-2xl font-black text-slate-800">ì¸/ë””ì½”ë“œ ìœ í‹¸ë¦¬í‹°</h2>
                        <p class="text-slate-500 text-xs">ë©€í‹° ì½”ë±ì„ í†µí•œ ë°ì´í„° ì •ë°€ í•´ë… ë„êµ¬ì…ë‹ˆë‹¤.</p>
                    </div>
                    <div class="flex bg-slate-100 p-1 rounded-xl">
                        <button onclick="codec.setMode('decode')" id="mode-decode" class="px-4 py-2 bg-white rounded-lg text-xs font-bold shadow-sm transition text-slate-800">Decode</button>
                        <button onclick="codec.setMode('encode')" id="mode-encode" class="px-4 py-2 text-slate-500 text-xs font-bold transition">Encode</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <label class="text-xs font-bold text-slate-400 uppercase">Input Data</label>
                        <textarea id="codec-input" class="w-full h-64 p-6 bg-slate-50 border border-slate-200 rounded-2xl text-sm font-mono outline-none" placeholder="ë³€í™˜í•  ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                    </div>
                    <div class="space-y-6">
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                            <button onclick="codec.run('url')" class="p-3 bg-slate-100 rounded-xl text-[11px] font-bold hover:bg-indigo-600 hover:text-white transition">URL</button>
                            <button onclick="codec.run('base64')" class="p-3 bg-slate-100 rounded-xl text-[11px] font-bold hover:bg-indigo-600 hover:text-white transition">Base64</button>
                            <button onclick="codec.run('hex')" class="p-3 bg-slate-100 rounded-xl text-[11px] font-bold hover:bg-indigo-600 hover:text-white transition">HEX</button>
                            <button onclick="codec.run('charcode')" class="p-3 bg-slate-100 rounded-xl text-[11px] font-bold hover:bg-indigo-600 hover:text-white transition">CharCode</button>
                            <button onclick="codec.run('gubun')" class="p-3 bg-slate-100 rounded-xl text-[11px] font-bold hover:bg-indigo-600 hover:text-white transition">Gubun</button>
                            <button onclick="codec.clear()" class="p-3 bg-rose-50 text-rose-600 rounded-xl text-[11px] font-bold">Clear</button>
                        </div>
                        <div class="space-y-2">
                            <label class="text-xs font-bold text-slate-400 uppercase">Output Result</label>
                            <div id="codec-output" class="w-full h-44 p-6 bg-slate-900 text-emerald-400 rounded-2xl text-sm font-mono overflow-y-auto whitespace-pre-wrap"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ì„¹ì…˜ 3: ì‹œìŠ¤í…œ ì ê²€ ì„¼í„° -->
        <section id="view-system" class="hidden space-y-6 fade-in">
            <div class="bg-indigo-900 text-white p-10 rounded-3xl shadow-2xl relative overflow-hidden mb-8">
                <div class="absolute -top-10 -right-10 w-64 h-64 bg-white/5 rounded-full blur-3xl"></div>
                <div class="relative z-10">
                    <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-8">
                        <div class="space-y-3">
                            <h2 class="text-3xl font-black">ì‹œìŠ¤í…œ ë³´ì•ˆ ì •ë°€ ì§„ë‹¨</h2>
                            <p class="text-indigo-200 text-sm max-w-lg">ëŒ€ìƒ IPë¥¼ ì—°ê²°í•˜ì—¬ 10ëŒ€ í•µì‹¬ ë³´ì•ˆ í•­ëª©ì„ ì „ìˆ˜ ì¡°ì‚¬í•©ë‹ˆë‹¤.</p>
                        </div>
                        <!-- ì‹œìŠ¤í…œ ì—°ê²° ê°€ì´ë“œ ë³´ê¸° ë²„íŠ¼ -->
                        <button onclick="system.showGuide()" class="px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-xs font-bold transition">
                            â“ ì—°ê²° ë°©ë²• ì•ˆë‚´ (Guide)
                        </button>
                    </div>
                    
                    <div id="system-target-zone" class="mt-8 flex flex-col md:flex-row gap-4 max-w-2xl bg-white/10 p-6 rounded-2xl border border-white/20 backdrop-blur-md">
                        <div class="flex-grow space-y-2">
                            <label class="text-[10px] font-bold uppercase text-indigo-300">Target IP / Hostname</label>
                            <input type="text" id="system-target-ip" class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-indigo-300 outline-none" placeholder="ì˜ˆ: 192.168.0.100">
                        </div>
                        <button onclick="system.connect()" id="btn-system-connect" class="px-8 py-3 bg-emerald-500 text-white rounded-xl font-black shadow-lg hover:bg-emerald-600 transition self-end">ì—°ê²° ë° ì§„ë‹¨</button>
                    </div>

                    <div id="system-connect-status" class="hidden mt-6 flex items-center gap-3">
                        <div class="w-2 h-2 bg-emerald-400 rounded-full animate-ping"></div>
                        <p class="text-xs font-mono text-emerald-300" id="system-status-text">SSH ì„¸ì…˜ ìˆ˜ë¦½ ì¤‘...</p>
                    </div>
                </div>
            </div>

            <!-- ì—°ê²° ê°€ì´ë“œ ëª¨ë‹¬/ì˜ì—­ -->
            <div id="system-guide-area" class="hidden bg-white p-8 rounded-3xl shadow-sm border border-indigo-100 mb-8 fade-in">
                <h3 class="text-lg font-bold text-indigo-900 mb-4 flex items-center gap-2">ğŸ›¡ï¸ ì‹œìŠ¤í…œ ì—°ê²° ìœ í˜• ë° ê°€ì´ë“œ</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-xs leading-relaxed">
                    <div class="p-4 bg-slate-50 rounded-2xl">
                        <p class="font-bold text-indigo-600 mb-2">1. SSH ì—°ê²° (Linux/Network)</p>
                        <p class="text-slate-500">ëŒ€ìƒ ì‹œìŠ¤í…œì˜ 22ë²ˆ í¬íŠ¸ê°€ ê°œë°©ë˜ì–´ ìˆì–´ì•¼ í•˜ë©°, root ê¶Œí•œ ë˜ëŠ” sudo ê¶Œí•œì„ ê°€ì§„ ê³„ì • ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    </div>
                    <div class="p-4 bg-slate-50 rounded-2xl">
                        <p class="font-bold text-indigo-600 mb-2">2. WMI ì—°ê²° (Windows Remote)</p>
                        <p class="text-slate-500">ìœˆë„ìš° ì›ê²© ê´€ë¦¬(WinRM) ì„œë¹„ìŠ¤ê°€ ê°€ë™ ì¤‘ì´ì–´ì•¼ í•˜ë©°, 135, 445 í¬íŠ¸ ì ‘ê·¼ì´ í—ˆìš©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</p>
                    </div>
                    <div class="p-4 bg-slate-50 rounded-2xl">
                        <p class="font-bold text-indigo-600 mb-2">3. Local Agent (ê¶Œì¥)</p>
                        <p class="text-slate-500">ì ê²€ ëŒ€ìƒ PCì—ì„œ ì§ì ‘ CERT ì—ì´ì „íŠ¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ê°€ì¥ ì •í™•í•˜ê³  ìƒì„¸í•œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.</p>
                    </div>
                </div>
                <button onclick="system.hideGuide()" class="mt-6 text-indigo-600 font-bold text-xs hover:underline">ê°€ì´ë“œ ë‹«ê¸°</button>
            </div>

            <div id="system-result" class="hidden space-y-8">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-4">
                        <div class="flex justify-between items-center px-2 mb-4">
                            <h3 class="font-bold text-slate-800">10ëŒ€ í•µì‹¬ ë³´ì•ˆ ì ê²€ ê²°ê³¼</h3>
                            <div class="flex gap-3 text-[10px] font-bold">
                                <span class="bg-emerald-100 text-emerald-600 px-2 py-1 rounded text-xs">ì–‘í˜¸: <span id="count-safe">0</span></span>
                                <span class="bg-rose-100 text-rose-600 px-2 py-1 rounded text-xs">ì·¨ì•½: <span id="count-vuln">0</span></span>
                            </div>
                        </div>
                        <div id="check-list-container" class="space-y-4"></div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-200 text-center">
                            <h4 class="text-xs font-bold text-slate-400 uppercase mb-4">ì¢…í•© ë³´ì•ˆ ì ìˆ˜</h4>
                            <div class="chart-container" style="height: 180px;"><canvas id="systemScoreChart"></canvas></div>
                            <p class="text-3xl font-black text-slate-800 mt-4" id="system-total-score">--</p>
                        </div>
                        <div class="bg-slate-900 text-white p-6 rounded-3xl shadow-xl border border-slate-800">
                            <h4 class="text-xs font-bold text-indigo-400 uppercase mb-4">CERT ì´ê´„ ì²˜ë°©ì „</h4>
                            <p id="system-advice" class="text-xs leading-relaxed italic text-slate-300">ëŒ€ìƒ ì—°ê²° í›„ ì§„ë‹¨í•˜ì‹­ì‹œì˜¤.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        // ---------------------------------------------------------
        // ì „ì—­ ì•± ê´€ë¦¬ì (ë¶„ì„ ì„¼í„°)
        // ---------------------------------------------------------
        const app = {
            state: { 
                currentView: 'analysis',
                currentTab: 'email',
                targetFile: '',
                isAnalyzing: false
            },
            
            init: function() {
                const dropZone = document.getElementById('file-drop-zone');
                if(!dropZone) return;
                dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('bg-indigo-50'); });
                dropZone.addEventListener('dragleave', () => { dropZone.classList.remove('bg-indigo-50'); });
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('bg-indigo-50');
                    const file = e.dataTransfer.files[0];
                    if(file) { this.state.targetFile = file.name; this.simulateAnalysis('file'); }
                });
            },

            switchView: function(viewId) {
                document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
                document.getElementById(`view-${viewId}`).classList.remove('hidden');
                this.state.currentView = viewId;
            },

            handleFileSelect: function(event) {
                const file = event.target.files[0];
                if(file) { this.state.targetFile = file.name; this.simulateAnalysis('file'); }
            },

            startEmailAnalysis: function() {
                const header = document.getElementById('email-header-input').value;
                if(!header && !confirm("í—¤ë”ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¶„ì„í• ê¹Œìš”?")) return;
                this.state.targetFile = "ìˆ˜ì‚¬ëŒ€ìƒ_ì´ë©”ì¼_í—¤ë”.eml";
                this.simulateAnalysis('email');
            },

            simulateAnalysis: function(type) {
                if(this.state.isAnalyzing) return;
                this.state.isAnalyzing = true;
                document.getElementById('analysis-input-stage').classList.add('hidden');
                document.getElementById('analysis-loader-stage').classList.remove('hidden');
                
                let progress = 0;
                const int = setInterval(() => {
                    progress += 5;
                    if(progress >= 100) { clearInterval(int); this.showAnalysisResult(); }
                }, 50);
            },

            showAnalysisResult: function() {
                this.state.isAnalyzing = false;
                document.getElementById('analysis-loader-stage').classList.add('hidden');
                document.getElementById('analysis-result-stage').classList.remove('hidden');
                document.getElementById('analysis-verdict-target').textContent = `ë¶„ì„ ëŒ€ìƒ: ${this.state.targetFile}`;
                this.renderAnalysisData();
                this.initAnalysisCharts();
            },

            switchTab: function(tabId) {
                this.state.currentTab = tabId;
                const tabs = ['email', 'network', 'system-log', 'cert-report'];
                tabs.forEach(t => {
                    const btn = document.getElementById(`tab-${t}`);
                    const content = document.getElementById(`content-${t}`);
                    if(t === tabId) {
                        btn.classList.add('bg-indigo-600', 'text-white');
                        btn.classList.remove('bg-white', 'text-slate-500');
                        content.classList.remove('hidden');
                        content.classList.add('fade-in');
                    } else {
                        btn.classList.remove('bg-indigo-600', 'text-white');
                        btn.classList.add('bg-white', 'text-slate-500');
                        content.classList.add('hidden');
                    }
                });
            },

            renderAnalysisData: function() {
                // ë”ë¯¸ ë°ì´í„° ë Œë”ë§ (ì´ì „ ë³µêµ¬)
                const hops = [ { l: "ìµœì¢… ëª©ì ì§€", d: "ìš°ë¦¬ ë©”ì¼ ì„œë²„ (10.0.1.5)" }, { l: "ì¤‘ê°„ ê²Œì´íŠ¸ì›¨ì´", d: "relay.attacker-site.ru (185.x.x.x)", danger: true } ];
                document.getElementById('mail-hop-container').innerHTML = hops.map(h => `
                    <div class="mail-hop-node ${h.danger ? 'border-none' : ''}">
                        <p class="text-xs font-bold ${h.danger ? 'text-rose-600' : 'text-slate-700'}">${h.l}</p>
                        <p class="text-[10px] text-slate-400">${h.d}</p>
                    </div>
                `).join('');

                const netData = [ { p: this.state.targetFile, r: "193.161.x.x", po: "4444", s: "ESTABLISHED" } ];
                document.getElementById('net-table-body').innerHTML = netData.map(d => `
                    <tr><td class="px-6 py-4 font-bold">${d.p}</td><td class="px-6 py-4 font-mono text-rose-600">${d.r}</td><td class="px-6 py-4">${d.po}</td><td class="px-6 py-4 text-emerald-600 font-bold">${d.s}</td></tr>
                `).join('');

                document.getElementById('sys-log-list').innerHTML = `<div class="p-4 border-b text-[11px] font-mono text-slate-500">11:02:15 - CreateFile: C:\\Windows\\Temp\\~payload.tmp (SUCCESS)</div>`;
                document.getElementById('report-verdict-list').innerHTML = `<li>- ë°œì‹ ì ìœ„ì¡° í”¼ì‹± ë©”ì¼ ê°ì§€</li><li>- C2 ì„œë²„ì™€ì˜ ë¹„ì •ìƒ ì„¸ì…˜ ìœ ì§€</li>`;
                document.getElementById('report-guide-list').innerHTML = `<li>- í•´ë‹¹ IP ë° ë„ë©”ì¸ ì¦‰ì‹œ ì°¨ë‹¨</li><li>- ì¹¨í•´ ë‹¨ë§ ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬</li>`;
            },

            initAnalysisCharts: function() {
                new Chart(document.getElementById('gaugeChart'), { type: 'doughnut', data: { datasets: [{ data: [92, 8], backgroundColor: ['#e11d48', '#f1f5f9'], borderWidth: 0, circumference: 180, rotation: 270 }] }, options: { cutout: '85%', plugins: { legend: { display: false } } } });
                new Chart(document.getElementById('authChart'), { type: 'doughnut', data: { labels: ['FAIL', 'NONE'], datasets: [{ data: [2, 1], backgroundColor: ['#f43f5e', '#94a3b8'] }] }, options: { plugins: { legend: { position: 'bottom' } } } });
                new Chart(document.getElementById('trafficLineChart'), { type: 'line', data: { labels: ['0s', '5s', '10s', '15s'], datasets: [{ label: 'KB/s', data: [2, 5, 450, 15], borderColor: '#6366f1', fill: true, backgroundColor: 'rgba(99, 102, 241, 0.1)', tension: 0.4 }] }, options: { plugins: { legend: { display: false } }, scales: { y: { display: false } } } });
            }
        };

        // ---------------------------------------------------------
        // ì½”ë± ì„¼í„° ë¡œì§
        // ---------------------------------------------------------
        const codec = {
            mode: 'decode',
            setMode: function(m) {
                this.mode = m;
                document.getElementById('mode-decode').className = m === 'decode' ? "px-4 py-2 bg-white rounded-lg text-xs font-bold shadow-sm transition text-slate-800" : "px-4 py-2 text-slate-500 text-xs font-bold transition";
                document.getElementById('mode-encode').className = m === 'encode' ? "px-4 py-2 bg-white rounded-lg text-xs font-bold shadow-sm transition text-slate-800" : "px-4 py-2 text-slate-500 text-xs font-bold transition";
            },
            run: function(type) {
                const input = document.getElementById('codec-input').value;
                if(!input) return alert("ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”!");
                let res = "";
                try {
                    if(type === 'url') res = this.mode === 'decode' ? decodeURIComponent(input) : encodeURIComponent(input);
                    else if(type === 'base64') res = this.mode === 'decode' ? atob(input) : btoa(input);
                    else if(type === 'hex') {
                        if(this.mode === 'decode') res = input.match(/.{1,2}/g).map(h => String.fromCharCode(parseInt(h, 16))).join('');
                        else res = Array.from(input).map(c => c.charCodeAt(0).toString(16).padStart(2, '0')).join('');
                    }
                    else if(type === 'charcode') {
                        if(this.mode === 'decode') res = input.split(/[\s,]+/).map(c => String.fromCharCode(parseInt(c))).join('');
                        else res = Array.from(input).map(c => c.charCodeAt(0)).join(', ');
                    }
                    else if(type === 'gubun') res = input.split('\n').map(l => l.substring(10, 61).trim()).join('\n');
                } catch(e) { res = "Error: " + e.message; }
                document.getElementById('codec-output').textContent = res;
            },
            clear: function() { document.getElementById('codec-input').value = ""; document.getElementById('codec-output').textContent = ""; }
        };

        // ---------------------------------------------------------
        // ì‹œìŠ¤í…œ ì ê²€ ì„¼í„° ë¡œì§
        // ---------------------------------------------------------
        const system = {
            checkItems: [
                { id: 1, cat: "ê³„ì •", title: "Guest ê³„ì • ìƒíƒœ", result: "ì·¨ì•½", score: 0, guide: " Guest ê³„ì •ì„ 'ë¹„í™œì„±í™”' ì²˜ë¦¬í•˜ê±°ë‚˜ 'net user guest /active:no'ë¥¼ ì‹¤í–‰í•˜ì‹­ì‹œì˜¤." },
                { id: 2, cat: "ê³„ì •", title: "ê´€ë¦¬ì ê³„ì •ëª… ë³€ê²½", result: "ì–‘í˜¸", score: 100, guide: "ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •ëª…(Administrator)ì„ ì¶”ì¸¡ì´ ì–´ë ¤ìš´ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ì‹­ì‹œì˜¤." },
                { id: 3, cat: "ì•”í˜¸", title: "ìµœì†Œ ì•”í˜¸ ê¸¸ì´", result: "ì·¨ì•½", score: 0, guide: "ë³´ì•ˆ ì •ì±…ì—ì„œ 'ìµœì†Œ ì•”í˜¸ ê¸¸ì´'ë¥¼ 8ì ì´ìƒìœ¼ë¡œ ê°•ì œ ì„¤ì •í•˜ì‹­ì‹œì˜¤." },
                { id: 4, cat: "ì•”í˜¸", title: "ì•”í˜¸ ë³µì¡ì„± ì •ì±…", result: "ì–‘í˜¸", score: 100, guide: "ì˜ë¬¸/ìˆ«ì/íŠ¹ìˆ˜ë¬¸ì ì¡°í•© ì‚¬ìš© ì„¤ì •ì„ ìœ ì§€í•˜ì‹­ì‹œì˜¤." },
                { id: 5, cat: "ë„¤íŠ¸ì›Œí¬", title: "ê¸°ë³¸ ê³µìœ  ì œê±°", result: "ì·¨ì•½", score: 0, guide: "C$, ADMIN$ ë“±ì˜ ê´€ë¦¬ ëª©ì  ê³µìœ  í´ë”ë¥¼ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì •ì„ í†µí•´ ì œê±°í•˜ì‹­ì‹œì˜¤." },
                { id: 6, cat: "ë„¤íŠ¸ì›Œí¬", title: "RDP ë³´ì•ˆ ì„¤ì •", result: "ì·¨ì•½", score: 0, guide: "ì›ê²© ë°ìŠ¤í¬í†± ì ‘ì† ì‹œ 'ë„¤íŠ¸ì›Œí¬ ìˆ˜ì¤€ ì¸ì¦(NLA)'ì„ ê°•ì œí•˜ì‹­ì‹œì˜¤." },
                { id: 7, cat: "ì„œë¹„ìŠ¤", title: "Telnet ì„œë¹„ìŠ¤ ì¤‘ì§€", result: "ì–‘í˜¸", score: 100, guide: "ë³´ì•ˆì´ ì·¨ì•½í•œ Telnet ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•˜ê±°ë‚˜ ì œê±°í•˜ì‹­ì‹œì˜¤." },
                { id: 8, cat: "ì„œë¹„ìŠ¤", title: "ìµëª… FTP í—ˆìš© ì—¬ë¶€", result: "ì–‘í˜¸", score: 100, guide: "FTP ì„œë²„ì˜ ìµëª… ì—°ê²°(Anonymous)ì„ ê¸ˆì§€í•˜ì‹­ì‹œì˜¤." },
                { id: 9, cat: "ì—…ë°ì´íŠ¸", title: "ìë™ ì—…ë°ì´íŠ¸ ì„¤ì •", result: "ì·¨ì•½", score: 0, guide: "ìœˆë„ìš° ì—…ë°ì´íŠ¸ê°€ í•­ìƒ ìµœì‹  ìƒíƒœë¡œ ìë™ ì„¤ì¹˜ë˜ë„ë¡ ì„¤ì •í•˜ì‹­ì‹œì˜¤." },
                { id: 10, cat: "ë‹¨ë§", title: "í™”ë©´ ë³´í˜¸ê¸° ì•”í˜¸", result: "ì–‘í˜¸", score: 100, guide: "ìë¦¬ ë¹„ì›€ ì‹œ ì¦‰ì‹œ ì•”í˜¸ ì ê¸ˆì´ ë˜ë„ë¡ ì„¤ì •í•˜ì‹­ì‹œì˜¤." }
            ],

            showGuide: function() { document.getElementById('system-guide-area').classList.remove('hidden'); },
            hideGuide: function() { document.getElementById('system-guide-area').classList.add('hidden'); },

            connect: function() {
                const ip = document.getElementById('system-target-ip').value;
                if(!ip) return alert("ëŒ€ìƒ IPë¥¼ ì…ë ¥í•˜ì„¸ìš”!");
                document.getElementById('system-connect-status').classList.remove('hidden');
                document.getElementById('btn-system-connect').disabled = true;
                setTimeout(() => { this.runCheck(); }, 2000);
            },

            runCheck: function() {
                document.getElementById('system-connect-status').classList.add('hidden');
                document.getElementById('system-result').classList.remove('hidden');
                const container = document.getElementById('check-list-container');
                container.innerHTML = "";
                let total = 0, safe = 0, vuln = 0;

                this.checkItems.forEach((item, idx) => {
                    total += item.score;
                    if(item.score === 100) safe++; else vuln++;
                    const div = document.createElement('div');
                    div.className = "bg-white rounded-2xl border border-slate-200 check-item overflow-hidden fade-in";
                    div.onclick = function() { this.classList.toggle('active'); };
                    div.innerHTML = `
                        <div class="p-6 flex justify-between items-center">
                            <div>
                                <span class="text-[9px] font-black px-2 py-0.5 rounded ${item.score === 100 ? 'bg-emerald-100 text-emerald-600' : 'bg-rose-100 text-rose-600'}">${item.cat}</span>
                                <h4 class="font-bold text-slate-800 text-sm mt-1">${item.title}</h4>
                            </div>
                            <span class="text-xs font-bold ${item.score === 100 ? 'text-emerald-500' : 'text-rose-500'}">${item.result}</span>
                        </div>
                        <div class="remedy-area bg-slate-50 border-t border-slate-100">
                            <div class="p-6"><p class="text-xs font-bold text-indigo-600 mb-1">ğŸ›¡ï¸ ì¡°ì¹˜ ë°©ë²•</p><p class="text-[11px] text-slate-600">${item.guide}</p></div>
                        </div>
                    `;
                    container.appendChild(div);
                });

                document.getElementById('count-safe').innerText = safe;
                document.getElementById('count-vuln').innerText = vuln;
                const score = Math.round(total/10);
                document.getElementById('system-total-score').innerText = score + "ì ";
                document.getElementById('system-advice').innerText = score < 80 ? "ë³´ì•ˆì´ ì·¨ì•½í•©ë‹ˆë‹¤! ì²˜ë°©ì „ì„ í™•ì¸í•˜ì—¬ ì¦‰ì‹œ ì¡°ì¹˜í•˜ì‹­ì‹œì˜¤." : "í›Œë¥­í•©ë‹ˆë‹¤! ì§€ê¸ˆì˜ ë³´ì•ˆ ìƒíƒœë¥¼ ìœ ì§€í•˜ì‹­ì‹œì˜¤.";
                this.initScoreChart(score);
            },

            initScoreChart: function(score) {
                const ctx = document.getElementById('systemScoreChart').getContext('2d');
                if(window.sysChart) window.sysChart.destroy();
                window.sysChart = new Chart(ctx, { type: 'doughnut', data: { datasets: [{ data: [score, 100-score], backgroundColor: [score < 70 ? '#e11d48' : '#10b981', '#f1f5f9'], borderWidth: 0, circumference: 180, rotation: 270 }] }, options: { cutout: '80%', plugins: { legend: { display: false } } } });
            }
        };

        window.onload = () => { app.init(); console.log("CERT Integrated Headquarters V3.2 Online."); };
    </script>
</body>
</html>
